# Bewise Test
**Тестовое задание.**

## Задача 1
С помощью Docker (предпочтительно - docker-compose) развернуть образ с любой опенсорсной СУБД (предпочтительно - PostgreSQL). Предоставить все необходимые скрипты и конфигурационные (docker/compose) файлы для развертывания СУБД, а также инструкции для подключения к ней. Необходимо обеспечить сохранность данных при рестарте контейнера (то есть - использовать volume-ы для хранения файлов СУБД на хост-машине.

## Задача 2
Реализовать на Python3 простой веб сервис (с помощью FastAPI или Flask, например), выполняющий следующие функции:
В сервисе должно быть реализовано REST API, принимающее на вход POST запросы с содержимым вида {"questions_num": integer}  ;

После получения запроса сервис, в свою очередь, запрашивает с публичного API (англоязычные вопросы для викторин) https://jservice.io/api/random?count=1 указанное в полученном запросе количество вопросов.
Далее, полученные ответы должны сохраняться в базе данных из п. 1, причем сохранена должна быть как минимум следующая информация (название колонок и типы данный можете выбрать сами, также можете добавлять свои колонки):
1. ID вопроса,
2. Текст вопроса,
3. Текст ответа,
4. Дата создания вопроса.

  В случае, если в БД имеется такой же вопрос, к публичному API с викторинами должны выполняться дополнительные запросы до тех пор, пока не будет получен уникальный вопрос для викторины.
Ответом на запрос из п.2.a должен быть предыдущей сохранённый вопрос для викторины. В случае его отсутствия - пустой объект.

## Добро пожаловать в проект Bewise Test
Этот проект представляет собой пример использования Docker, Flask, PostgreSQL и Python для создания простого веб-приложения, которое выполняет запросы к внешнему API и сохраняет данные в базу данных. Помимо работа REST API Post запросов к api point также реализовано возможность проверки работы апи прямо на странице проекта.

### Требования
Прежде чем начать, убедитесь, что у вас установлены следующие инструменты:
- Docker
- Docker Compose
- Git

### Запуск приложения
1. Склонируйте проект с помощью Git:
   ```bash
   git clone https://github.com/ramires666/bewise_test.git
   cd bewise_test

2. Создайте файл .env в корневой директории проекта и определите в нем переменные окружения для настройки приложения. Пример .env файла:

    ```bash
    POSTGRES_USER=uzver
    POSTGRES_PASSWORD=supperpupperpassword
    POSTGRES_DB=bewisedb
    API_ENDPOINT_LOCAL=http://localhost:5000/get_questions
    API_ENDPOINT_PROD=http://642e077a500a.sn.mynetname.net/get_questions
    ```

3. Соберите и запустите приложение с помощью Docker Compose:
   
   ```bash
   docker-compose up --build
   ```
    Docker Compose автоматически создаст и настроит контейнеры для веб-приложения и базы данных PostgreSQL.


### Использование
  На главной странице приложения вы можете указать количество запрашиваемых страниц и выполнить POST-запрос к внешнему API. Приложение отправит запрос, получит данные и сохранит их в базу данных PostgreSQL.В ответе выдается результат предпоследней записи в базу данных, как требуется по ТЗ, то есть не самый последний вопрос а предыдущий.

1. После успешного запуска приложения для доступа к приложению откройте веб-браузер и перейдите по адресу заданного выше API_ENDPOINT_PROD
   
   ```bash
   http://642e077a500a.sn.mynetname.net/get_questions
    ```
    или
    ```bash
    http://localhost:5000
    ```
    если запущено локально, а не на сервере.
   
2. При перезапуске docker-compose данные базы данных сохраняются, как требуется по ТЗ так как лежат в отдельном volume:"/var/lib/docker/volumes/bewise_test_db_data/_data"

3. Управление Docker
  Для остановки приложения и контейнеров используйте команду:
       
      ```bash
      docker-compose down
    ```
      Для удаления образов и контейнеров используйте команду:
    
    ```bash
    docker-compose down --volumes
    ```
